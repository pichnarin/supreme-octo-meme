<p-toast position="top-right"></p-toast>

<div class="px-6 py-4 animate-fade-in">
  <!-- Compact Header -->
  <div class="flex items-center justify-between mb-4">
    <div class="flex items-center gap-3">
      <div class="p-2 rounded-lg bg-gradient-to-br from-indigo-50 to-purple-50">
        <i class="pi pi-wallet text-3xl text-indigo-600"></i>
      </div>
      <div>
        <h1 class="text-lg font-bold text-gray-800 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
          {{ 'app.title' | translate }}
        </h1>
        <p class="text-xs text-indigo-600 font-medium">{{ 'app.company' | translate }}</p>
      </div>
    </div>
    <!-- Language Switcher -->
    <p-dropdown
      [options]="languages"
      [(ngModel)]="selectedLanguage"
      (onChange)="onLanguageChange($event.value)"
      optionLabel="nativeName"
      styleClass="w-36"
      [style]="{'font-size': '0.875rem'}">
      <ng-template pTemplate="selectedItem">
        <div class="flex items-center gap-2" *ngIf="selectedLanguage">
          <span>{{ selectedLanguage.flag }}</span>
          <span class="text-sm">{{ selectedLanguage.nativeName }}</span>
        </div>
      </ng-template>
      <ng-template let-language pTemplate="item">
        <div class="flex items-center gap-2">
          <span>{{ language.flag }}</span>
          <span class="text-sm">{{ language.nativeName }}</span>
        </div>
      </ng-template>
    </p-dropdown>
  </div>

  <!-- Login Title -->
  <div class="text-center mb-4">
    <h2 class="text-xl font-bold text-gray-800">{{ 'auth.login.title' | translate }}</h2>
    <p class="text-sm text-gray-600">{{ 'auth.login.subtitle' | translate }}</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="animate-shake mb-3">
    <p-message
      severity="error"
      [text]="errorMessage"
      styleClass="w-full">
    </p-message>
  </div>

  <!-- Login Form -->
  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
    <!-- Username -->
    <div class="mb-3">
      <label for="username" class="block text-sm font-medium text-gray-700 mb-1">
        {{ 'auth.login.username' | translate }} <span class="text-red-500">*</span>
      </label>
      <input
        pInputText
        id="username"
        formControlName="username"
        [placeholder]="'auth.login.usernamePlaceholder' | translate"
        class="w-full"
        [class.ng-invalid]="usernameInvalid"
        [class.ng-dirty]="usernameInvalid"
        autocomplete="username" />
      <small class="text-red-500 text-xs mt-1 block" *ngIf="usernameInvalid">
        {{ 'auth.login.usernameRequired' | translate }}
      </small>
    </div>

    <!-- Password -->
    <div class="mb-3">
      <label for="password" class="block text-sm font-medium text-gray-700 mb-1">
        {{ 'auth.login.password' | translate }} <span class="text-red-500">*</span>
      </label>
      <p-password
        id="password"
        formControlName="password"
        [placeholder]="'auth.login.passwordPlaceholder' | translate"
        styleClass="w-full"
        [inputStyle]="{'width': '100%'}"
        [class.ng-invalid]="passwordInvalid"
        [class.ng-dirty]="passwordInvalid"
        [toggleMask]="true"
        [feedback]="false"
        autocomplete="current-password">
      </p-password>
      <small class="text-red-500 text-xs mt-1 block" *ngIf="passwordInvalid">
        {{ 'auth.login.passwordRequired' | translate }}
      </small>
    </div>

    <!-- Remember Me & Forgot Password -->
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center gap-2">
        <p-checkbox
          formControlName="rememberMe"
          [binary]="true"
          inputId="rememberMe">
        </p-checkbox>
        <label for="rememberMe" class="text-sm cursor-pointer text-gray-700 hover:text-gray-900 transition-colors">
          {{ 'auth.login.rememberMe' | translate }}
        </label>
      </div>
      <a
        href="javascript:void(0)"
        (click)="onForgotPassword()"
        class="text-sm text-indigo-600 hover:text-indigo-700 font-medium transition-colors hover:underline">
        {{ 'auth.login.forgotPassword' | translate }}
      </a>
    </div>

    <!-- Submit Button -->
    <p-button
      type="submit"
      [label]="'auth.login.loginButton' | translate"
      icon="pi pi-sign-in"
      styleClass="w-full login-button mb-4"
      [loading]="loading"
      [disabled]="loading">
    </p-button>
  </form>

  <!-- Demo Credentials - Collapsible -->
  <div class="mt-3">
    <div class="text-center mb-3">
      <button
        type="button"
        (click)="showDemoCredentials = !showDemoCredentials"
        class="text-sm text-gray-600 hover:text-indigo-600 font-medium transition-colors flex items-center justify-center gap-2 mx-auto">
        <i class="pi" [ngClass]="showDemoCredentials ? 'pi-chevron-up' : 'pi-chevron-down'"></i>
        {{ showDemoCredentials ? ('auth.login.hideDemoCredentials' | translate) : ('auth.login.showDemoCredentials' | translate) }}
      </button>
    </div>

    <div *ngIf="showDemoCredentials" class="space-y-2 animate-slide-down">
      <div
        class="flex items-center justify-between p-2 bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg border border-gray-200 hover:border-indigo-300 hover:shadow transition-all duration-200 cursor-pointer group"
        *ngFor="let user of mockUsers"
        (click)="fillCredentials(user.username, user.password)">
        <div class="flex flex-col">
          <strong class="text-xs text-gray-800 group-hover:text-indigo-600 transition-colors">{{ user.role }}</strong>
          <span class="text-xs text-gray-500 font-mono">{{ user.username }} / {{ user.password }}</span>
        </div>
        <i class="pi pi-arrow-right text-gray-400 group-hover:text-indigo-600 transition-all text-sm"></i>
      </div>

      <!-- Compact Security Notice -->
      <div class="p-2 bg-amber-50 border border-amber-200 rounded-lg">
        <div class="flex gap-2 items-start">
          <i class="pi pi-info-circle text-amber-600 text-xs mt-0.5"></i>
          <p class="text-xs text-amber-800 leading-tight">
            {{ 'auth.login.demoNotice' | translate }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
